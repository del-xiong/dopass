var Class=g_core_heritage.Class,unloadNS=g_core_namespace.ns(),unload=g_system_unload.when,Unloader=exports.Unloader=Class({initialize:function(){unloadNS(this).unloaders=[];unloadNS(this).unloadersUnload=unloadersUnload.bind(null,unloadNS(this).unloaders);unload(unloadNS(this).unloadersUnload)},unload:function(b,a){function c(){try{b()}catch(a){console.error(a)}}if(null==b)return unloadNS(this).unloadersUnload(),null;var d=windowUnloader.bind(null,c,unloadNS(this).unloaders);if(null!=a){a.addEventListener("unload",
d,!1);var e=b;b=function(){a.removeEventListener("unload",d,!1);e()}}unloadNS(this).unloaders.push(c);return removeUnloader.bind(null,c,unloadNS(this).unloaders)}});function sliceUnloader(b,a){var c=a.indexOf(b);return 0>c?[]:a.splice(c,1)}function removeUnloader(b,a){sliceUnloader.apply(null,arguments)}function windowUnloader(b,a){sliceUnloader.apply(null,arguments).forEach(function(a){return a()})}function unloadersUnload(b){b.slice().forEach(function(a){return a()});b.length=0}var gUnload=Unloader();
exports.unload=gUnload.unload.bind(gUnload);
